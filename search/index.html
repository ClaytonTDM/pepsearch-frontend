<!DOCTYPE html>
<html lang="en-us">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width">
      <title>Prizmarine - Search</title>
      <link href="../style.css" rel="stylesheet" type="text/css" />
      <link rel="shortcut icon" type="image/png" href="../assets/logo-icon.png" />
      <script src="https://cdn.tailwindcss.com"></script>
      <meta name="title" content="Prizmarine - Simple Search Engine">
      <meta name="description" content="Prizmarine gives efficient search results and a streamlined user experience with good design, too.">
      <meta name="og:title" content="Prizmarine - Simple Search Engine">
      <meta name="og:description" content="Prizmarine gives efficient search results and a streamlined user experience with good design, too.">
      <meta name="keywords" content="google, gce, search engine, search, bing">
      <meta name="robots" content="index, follow">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="language" content="English">
      <meta name="revisit-after" content="1 days">
   </head>
   <body>
      <center>
  <div class="max-w-md mx-auto bg-black p-6 rounded-lg shadow-md">
    <form id="search-form" class="flex items-center">
      <input
        type="text"
        id="query"
        placeholder="Enter your search query"
        required
        class="w-full px-4 py-2 bg-neutral-600 border border-gray-300 rounded-l focus:outline-none"
      />
      <button
        type="submit"
        id="submit"
        class="bg-blue-500 text-white px-4 py-2 rounded-r"
      >
        Search
      </button>
    </form>
  </div>
</center>
<br>
<script>
  function side_toggle() {
    document.getElementById("mayzer").classList.toggle("hidden")
  }
</script>

<div class="float-right sticky top-0">
  <button class="bg-blue-500 text-white px-4 py-2 rounded-r" onclick="side_toggle()">&#9776;</button>
</div>

<div id="mayzer" class="sticky top-0 container bg-slate-800 max-w-screen-sm w-full h-full aspect-square float-right hidden">
  <iframe src="https://armai-dev.github.io/Mayzer/" frameborder="0" class="border-4 border-zinc-600 border-dashed right-0 w-full max-w-screen-sm aspect-square"></iframe>
</div>


   <div id="results">
    </div>
   <style>
     a {
            font-size: 20px;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        p {
            color: #eeeeee;
        }
        #results {
            margin-top: 16px;
	    padding-left: 23px;
	    margin-right: 10px;
        }
	@media only screen and (max-width: 975px) {
  #result {
     margin-top: 16px;
     padding-left: 0px;
	  

    
  }
}

</style>
    <script>
        const form = document.getElementById('search-form');
        const queryInput = document.getElementById('query');
        const resultsDiv = document.getElementById('results');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const query = queryInput.value.trim();
            
            // Replace '<YOUR_API_KEY>' with your actual API key
            const apiKey = 'BSAZHgSxSA-qJamxaRM-1y4U_G-LPVV';
            
            // Make a request to the Brave Search API
            const badApiUrl = `https://api.search.brave.com/res/v1/web/search?q=${encodeURIComponent(query)}`;
            // const originalUrl = 'https://api.search.brave.com/res/v1/web/search?q=cool%20rocks';
            const apiUrl = 'https://corsproxy.io/?' + encodeURIComponent(badApiUrl);
            const headers = {
                'Accept': 'application/json',
                'Accept-Encoding': 'gzip',
                'X-Subscription-Token': apiKey
            };

            try {
                const response = await fetch(apiUrl, { headers });
                const data = await response.json();
                displayResults(data);
                boldText(query)
            } catch (error) {
                console.error('Error fetching data:', error);
                resultsDiv.innerHTML = '<p>An error occurred while fetching results.</p>';
            }
        });

        function displayResults(data) {
    // Clear previous results
    resultsDiv.innerHTML = '';

    if (data.web && data.web.results && data.web.results.length > 0) {
        data.web.results.forEach((result) => {
            const resultDiv = document.createElement('div');
            resultDiv.classList.add('result-item');
            resultDiv.innerHTML = `
                <code style="color: #eee; font-size: 16px;"><img src="${result.meta_url.favicon}" width="16" style="margin-right: 5px; margin-bottom: -2px;">${result.meta_url.scheme}://${result.meta_url.hostname} ${result.meta_url.path}</code>
                <p style="margin-bottom: 0; margin-top: 4px;"><a href="${result.url}" target="_blank" style="color: #8ab4f8;">${result.title}</a></p>
                <p style="margin-top: 5px; color: #ccc;">${result.description}</p>
                <br>
            `;
            resultsDiv.appendChild(resultDiv);
        });
    } else {
        resultsDiv.innerHTML = '<p>No results found.</p>';
    }
}

function boldText(queryString) {
// Get all <a> elements within the <div id="results">
let links = document.querySelectorAll("#results .result-item p a");

// Function to escape special characters in a string for RegExp
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

// Loop through each <a> element
links.forEach(function(link) {
  // Get the text content of the link
  let linkText = link.textContent;

  // Loop through each word in the query
  queryString.split(" ").forEach(function(keyword) {
    // Create a regular expression to match the whole word, case-insensitive
    let regex = new RegExp("\\b" + escapeRegExp(keyword) + "\\b", "gi");

    // Replace all occurrences of the matched keyword with the <strong> element
    linkText = linkText.replace(regex, function(match) {
      return "<strong>" + match + "</strong>";
    });
  });

  // Update the link's HTML with the bolded text
  link.innerHTML = linkText;
});
}
      function getUrlParameter(sParam) {
          var sPageURL = window.location.search.substring(1);
          var sURLVariables = sPageURL.split('&');
          for (var i = 0; i < sURLVariables.length; i++)
          {
          var sParameterName = sURLVariables[i].split('=');
          if (sParameterName[0] == sParam)
          {
          return sParameterName[1];
      }}}

      // console.log(getUrlParameter('q')) // This will print the search query
      if (getUrlParameter('q') !== undefined && getUrlParameter('q') !== '') {
      document.title = 'Pepsearch - ' + getUrlParameter('q')
      document.getElementById('query').value = getUrlParameter('q')
      document.getElementById('submit').click()
      } else {
        
      }

      document.getElementById('submit').addEventListener('click', function() {
        window.history.pushState("", "Pepsearch", `/?q=${document.getElementById('query').value}`);
        // console.log('WOOOPS....something happened')
      })
        </script> <!-- now all that needs to be done is styling the site to be resulti -->
      <style>
        .peps-logo{padding-top:64px;padding-bottom:64px;max-width:100%;height:auto;}
        @media screen and (max-width:768px){.peps-logo{max-width:100%;}}
        body{background-color:#40444b;color:white;}
        .gsc-result-info,.gsc-orderby-label {color:white;}
     </style>
      <script src="/assets/bangs.js"></script>
     <script src="/assets/searchpage.js"></script>
   </body>
</html>
